{"version":3,"sources":["component/beauty.jpg","component/header.js","component/footer.js","component/loading.js","App.js","reportWebVitals.js","index.js","model/index.js","store/history.js","store/user.js","store/image.js","store/auth.js","store/index.js"],"names":["Header","styled","header","Div","h1","Logo","img","StyledLink","NavLink","StyledButton","Button","H3","h3","Component","observer","useStore","AuthStore","UserStore","history","useHistory","src","imgUrl","alt","to","exact","style","textDecoration","activeClassName","currentUser","values","username","type","onClick","resetUser","logOut","console","log","push","FooterStyled","footer","Footer","loading","Home","lazy","History","About","Login","Register","App","fallback","path","component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById","AV","init","appId","appKey","serverURL","Auth","register","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","signUpUser","error","login","logIn","loginUser","getCurrentUser","current","Uploader","add","filename","file","item","Object","avFile","File","set","save","serverFile","find","page","limit","query","Query","include","skip","descending","equalTo","results","catch","window","newList","this","list","concat","isLoading","append","length","hasMore","message","finally","observable","action","makeObservable","newfileName","fileName","newFile","isUploading","pullUser","err","success","HistoryStore","reset","ImageStore","context","createContext","stores","useContext"],"mappings":"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","file":"static/js/main.b1ee02da.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/beauty.f7a105fa.jpg\";","import React,{useState, useEffect} from 'react';\r\nimport imgUrl from './beauty.jpg'\r\nimport styled from 'styled-components'\r\nimport {NavLink}  from 'react-router-dom';\r\nimport { Button } from 'antd';\r\nimport { useStore } from '../store';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { observer } from 'mobx-react';\r\n\r\n\r\nconst Header = styled.header`\r\ndisplay:flex;\r\nalign-items:center;\r\nbackground-color:#02101f;\r\nfont-size:20px;\r\n`;\r\n\r\nconst Div=styled.h1`\r\ndisplay:inline-block;\r\ncolor:white;\r\nmargin-left:30px;\r\nmargin-right:90px;\r\n`\r\nconst Logo = styled.img`\r\nwidth: 100px;\r\nheight: auto;\r\ndisplay:inline-block;\r\n`\r\nconst StyledLink=styled(NavLink)`\r\ncolor:#fff;\r\nmargin-left:60px;\r\n&.active{\r\n    border-bottom:1px solid white;\r\n}\r\n`\r\nconst StyledButton=styled(Button)`\r\nmargin-left:40px;\r\n`\r\nconst H3=styled.h3`\r\ncolor:#fff;\r\nmargin-top:12px;\r\nmargin-left:40px;\r\n`\r\n\r\n\r\nconst  Component = observer(() => {\r\n   const {AuthStore,UserStore} =useStore();\r\n   const history = useHistory();\r\n   \r\n\r\n   const handleLogOut=()=>{\r\n    UserStore.resetUser()\r\n    AuthStore.logOut()\r\n    console.log('注销，清除当前用户信息')\r\n   };\r\n   const handleLogin=()=>{\r\n       history.push('/login')\r\n      console.log('跳转到登录页面')\r\n   };\r\n   const handleRegister=()=>{\r\n    history.push('/register')\r\n    console.log('跳转到注册页面')   \r\n   };\r\n    return(\r\n        <Header>    \r\n        <Div>Epic图床</Div>\r\n        <Logo src={imgUrl} alt='beauty' /> \r\n        <nav>\r\n            <StyledLink to=\"/\" exact style={{textDecoration:'none'}}  activeClassName=\"active\" > 首页</StyledLink>\r\n            <StyledLink to=\"/history\" style={{textDecoration:'none'}}   activeClassName=\"active\">上传历史</StyledLink>\r\n            <StyledLink to=\"/about\" style={{textDecoration:'none'}}  activeClassName=\"active\">关于我</StyledLink>\r\n        </nav>\r\n        <>{\r\n         UserStore.currentUser? \r\n        <>\r\n        <H3>{AuthStore.values.username}</H3>\r\n        <StyledButton  type=\"primary\" onClick={handleLogOut}> 注销 </StyledButton>\r\n        </>: <>       \r\n        <StyledButton  type=\"primary\" onClick={handleLogin}> 登录</StyledButton>\r\n        <StyledButton  type=\"primary\" onClick={handleRegister}> 注册  </StyledButton>\r\n        </>\r\n        }\r\n        </>\r\n        </Header>\r\n    )\r\n});\r\n\r\nexport default Component;\r\n\r\n// 这里出现第一个bug，","import React from 'react';\r\nimport styled from 'styled-components'\r\n\r\nconst FooterStyled=styled.footer`\r\npadding:10px 100px;\r\ntext-align:center;\r\nfont-size:12px;\r\ncolor:#aaa;\r\n`;\r\n    \r\n\r\n\r\nfunction Footer(){\r\n    return(\r\n        <FooterStyled>\r\n        <h1>Footer</h1>\r\n        </FooterStyled>\r\n    )\r\n}\r\n\r\nexport default Footer;","/* eslint-disable import/no-anonymous-default-export */\r\nimport React from \"react\";\r\n\r\n\r\n function loading(){\r\n    return(\r\n        <div> Loading... </div>\r\n    );\r\n}\r\n\r\nexport default loading;","import './App.css';\nimport React ,{Suspense,lazy}from 'react';\nimport Header from './component/header';\nimport Footer from './component/footer';\nimport Loading from './/component/loading';\nimport 'antd/dist/antd.css'\nimport {\n    Switch,\n    Route,\n  } from 'react-router-dom';\n  const Home =lazy(()=>import('./view/home'));\n  const History =lazy(()=>import('./view/history'));\n  const About =lazy(()=>import('./view/about'));\n  const Login=lazy(()=>import('./view/login.js'));\n  const Register=lazy(()=>import('./view/register.js'))\n\nfunction App() {\n  return (\n    <>\n     <Header/>\n     <main>\n     <Suspense fallback={<Loading/>} >\n        <Switch>\n          <Route path=\"/\" exact component={Home}/>\n          <Route path='/history' component= {History}  />\n          <Route path=\"/about\" component={About} />\n          <Route path=\"/login\" component={Login} />\n          <Route path=\"/register\" component={Register} />\n        </Switch>\n      </Suspense>\n      </main>\n     <Footer/>\n     </>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport{\n  HashRouter as Router\n} from 'react-router-dom'\nimport Model from './model/index'\n\n\n\nReactDOM.render(\n    <Router>\n    <App />\n    </Router>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import AV,{Query,User} from 'leancloud-storage'\r\n\r\nAV.init({ //安装规范对AV初始化\r\n    appId:\"34eLG26lSun8CGKdE28ayYJY-gzGzoHsz\",\r\n    appKey:\"5y1j3cbdC3DUo6joCdq6iKkU\",\r\n    serverURL:\"https://34elg26l.lc-cn-n1-shared.com\",\r\n})\r\n\r\n//封装一个Auth对象，待会再导出去，让其他页面也能使用，Auth对象\r\n\r\nconst Auth={ //Auth是个对象，封装了几个工具方法\r\n    //register现在有问题，_a 不识别，报错\r\n    register(username,password){  //register是一个工具方法，用来管理注册的一系列行为\r\n    var user=new AV.User(); //User是AV里封装好的类，哪里直接用\r\n    user.setUsername(username); //user对象是刚构造好的对象，里面有包自带的工具方法，通过这些工具方法可以实现后端的功能\r\n    user.setPassword(password);\r\n    return new Promise((resolve,reject)=>{\r\n        user.signUp().then(signUpUser=>resolve(signUpUser),error=> reject(error))  \r\n    })\r\n},\r\n   login(username,password){ // login函数现在暂时是能行\r\n    return new Promise((resolve,reject)=>{\r\n        User.logIn(username,password).then(loginUser=>resolve(loginUser),error=> reject(error))\r\n    })\r\n   },\r\n   logOut(){\r\n       User.logOut();//忘记大小写是Out\r\n   },\r\n   getCurrentUser(){\r\n      return User.current();\r\n   },\r\n   }\r\n\r\n   const Uploader={\r\n       add(filename,file){\r\n           const item=new AV.Object('image')\r\n           var avFile = new AV.File(filename, file);\r\n           item.set('title', filename);\r\n           item.set('owner', AV.User.current());\r\n           item.set('url', avFile);\r\n           return new Promise((resolve,reject)=>{\r\n             item.save().then((serverFile=>resolve(serverFile)),error=>reject(error))\r\n           })\r\n       },\r\n       find({page=0, limit=10}) {\r\n        const query = new AV.Query('Image');\r\n        query.include('owner');\r\n        query.limit(limit);\r\n        query.skip(page*limit);\r\n        query.descending('createdAt');\r\n        query.equalTo('owner', AV.User.current());\r\n        return new Promise((resolve, reject) => {\r\n          query.find()\r\n            .then(results => resolve(results))\r\n            .catch(error => reject(error))\r\n        });\r\n      }\r\n   }\r\n\r\n  window.Uploader=Uploader;\r\n\r\n// eslint-disable-next-line import/no-anonymous-default-export\r\nexport {Auth, Uploader}; //把Auth对象导出去\r\n\r\n\r\n\r\n\r\n","import { observable, action } from 'mobx';\r\nimport { Uploader } from '../model';\r\nimport { message } from 'antd';\r\n\r\n\r\nclass HistoryStore {\r\n  @observable list = [];\r\n  @observable isLoading = false;\r\n  @observable hasMore = true;\r\n  @observable page = 0;\r\n  limit = 10;\r\n\r\n  @action append(newList) { // 再旧的用户的列表上，添加新的列表，就像新上传了图片，列表就要多添加一条记录了\r\n    this.list = this.list.concat(newList);\r\n  }\r\n\r\n  @action find() {\r\n    this.isLoading = true;\r\n    Uploader.find({page: this.page, limit: this.limit})\r\n      .then(newList => {\r\n        this.append(newList);\r\n        this.page++;\r\n        if(newList.length < this.limit) {\r\n          this.hasMore = false;\r\n        }\r\n      }).catch(error => {\r\n        message.error('加载数据失败');\r\n      }).finally(() => {\r\n        this.isLoading = false;\r\n      });\r\n  }\r\n\r\n  @action reset() { //用户注销\r\n    this.list = [];\r\n    this.isLoading = false;\r\n    this.hasMore = true;\r\n    this.page = 0;\r\n  }\r\n\r\n}\r\n\r\n\r\nexport default new HistoryStore();\r\n","import { message } from 'antd';\r\nimport { observable,action,makeObservable} from 'mobx'\r\nimport {Auth} from '../model'\r\n\r\n// 这个AuthStore存储的是，用户临时的登录信息，以及部分的操作逻辑，我觉得属于VM层的内容\r\nclass UserStore{  // AuthStore是一个对象，Auth也是一个对象，两个对象都有自己的属性和方法，而AuthStore的工具方法，是来自Auth对象的工具方法，并且对其进行了修饰\r\n    constructor(){\r\n        makeObservable(this)\r\n    };\r\n\r\n    @observable currentUser=null;\r\n\r\n    @action pullUser(){\r\n        this.currentUser=Auth.getCurrentUser()\r\n    }\r\n    @action resetUser(){\r\n        this.currentUser=null;\r\n    }\r\n\r\n}\r\nexport default new UserStore();\r\n\r\n\r\n\r\n\r\n","import { message } from 'antd';\r\nimport { observable,action,makeObservable} from 'mobx'\r\nimport {Uploader} from '../model'\r\n\r\n// 这个ImageStore存储的是，用户上传的图片信息，以及部分的操作逻辑，我觉得属于VM层的内容\r\nclass ImageStore{  // ImageStore是一个对象，UpLoader也是一个对象，两个对象都有自己的属性和方法，而UpLoader的工具方法，是来自Auth对象的工具方法，并且对其进行了修饰\r\n    constructor(){\r\n        makeObservable(this)\r\n    };\r\n\r\n    @observable fileName='';\r\n\r\n    @observable file=null;\r\n\r\n    @observable isUploading=false;\r\n\r\n    @observable serverFile=null;\r\n\r\n    @action setFileName(newfileName){\r\n        this.fileName=newfileName;\r\n    };\r\n    @action setFile(newFile){\r\n        this.file=newFile;\r\n    };\r\n    @action upLoad(){\r\n        this.isUploading=true;\r\n        this.serverFile=null;\r\n        return new Promise((resolve,reject)=>{\r\n            Uploader.add(this.fileName,this.file)\r\n            .then(serverFile=>{\r\n                this.serverFile=serverFile\r\n                console.log('上传成功')\r\n                resolve(serverFile)\r\n            })\r\n            .catch(error=>{\r\n                console.log('上传失败')\r\n                reject(error)\r\n            })\r\n        }) \r\n    }\r\n    @action reset(){\r\n       this.isUploading=false;\r\n       this.serverFile=null;\r\n    }\r\n\r\n}\r\nexport default new ImageStore();","import { message } from 'antd';\r\nimport { observable,action,makeObservable} from 'mobx'\r\nimport HistoryStore from './history'\r\nimport {Auth} from '../model'\r\nimport UserStore from './user'\r\nimport ImageStore from './image'\r\n\r\n// 这个AuthStore存储的是，用户临时的登录信息，以及部分的操作逻辑，我觉得属于VM层的内容\r\nclass AuthStore{  // AuthStore是一个对象，Auth也是一个对象，两个对象都有自己的属性和方法，而AuthStore的工具方法，是来自Auth对象的工具方法，并且对其进行了修饰\r\n    constructor(){\r\n        makeObservable(this)\r\n    };\r\n    @observable values={\r\n        username:'',\r\n        password:'',\r\n    };\r\n  @action setUsername(username){\r\n      this.values.username=username;\r\n  };\r\n  @action setPassword(password){\r\n      this.values.password=password;\r\n  };\r\n  @action login(){ //登录逻辑\r\n    return new Promise((resolve,reject)=>{  // promise是一个ES6自带的构造函数，会生成一个Promise对象，传进去的参数是一个箭头函数。定义如果事件成功执行什么，事件失败执行什么\r\n      Auth.login(this.values.username,this.values.password) //成功之后可以做一些事情，那就是用then和catch，如果事件成功就执行then代码，如果事件失败就执行catch代码\r\n       .then(user=>{\r\n            UserStore.pullUser();\r\n            resolve(user)})\r\n        .catch(err=>{\r\n            UserStore.resetUser();\r\n            reject(err)});\r\n        })\r\n  };\r\n\r\n  @action register(){ //注册逻辑\r\n    return new Promise((resolve,reject)=>{\r\n        Auth.register(this.values.username,this.values.password)\r\n        .then(user=>{\r\n            message.success('注册成功，正准备跳转到登录页面')\r\n            UserStore.pullUser();\r\n            resolve(user);\r\n            })\r\n        .catch(err=>{\r\n            message.success('注册失败，请您稍后再试')\r\n            UserStore.resetUser();\r\n            reject(err);\r\n            })\r\n        })\r\n  };\r\n  @action logOut(){\r\n      console.log('注销');\r\n      HistoryStore.reset();\r\n      UserStore.resetUser();\r\n      ImageStore.reset();\r\n      this.values.password='';\r\n      this.values.username='';\r\n      Auth.logOut();\r\n  }\r\n}\r\nexport default new  AuthStore();\r\n\r\n\r\n\r\n\r\n","import {createContext,useContext} from 'react';\r\n// import {AuthStore} from './auth'; 以前的AuthStore是类\r\nimport AuthStore from './auth';\r\nimport UserStore from './user';\r\nimport ImageStore from './image'\r\nimport HistoryStore from './history'\r\n\r\nconst context = createContext({\r\n    HistoryStore,\r\n    AuthStore,\r\n    UserStore,\r\n    ImageStore \r\n}); //context是createContext函数的返回值，该函数的传参是个对象  \r\n\r\nwindow.stores = {\r\n    AuthStore,\r\n    UserStore,\r\n    ImageStore,\r\n    HistoryStore,\r\n    // ImageStore,\r\n    // HistoryStore\r\n  };\r\n\r\n//这里好奇怪，有点像是，用对象封装了一个对象，用函数导出了一个函数\r\n\r\nexport const useStore =()=> useContext(context) //导出了一个函数，该函数的内容是执行另一个函数 userStore\r\n\r\n//每个功能组的核心都是index，index相当于每个功能的引用中心，内部通常不含解决需求的代码，但作用是引入其他解决需求的代码\r\n\r\n//auth.js创建的是类，而不是对象，在index里面才创建为对象的。对象是类的实例，相当于对象的设计图，如果创建了类，想使用对象里的方法，必须先得构建出类的实例，即对象"],"sourceRoot":""}